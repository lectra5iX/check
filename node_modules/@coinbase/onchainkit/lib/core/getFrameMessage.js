'use strict';

const neynarFrameFunctions = require('../utils/neynar/frame/neynarFrameFunctions.js');

/**
 * Given a frame message, decode and validate it.
 *
 * If message is valid, return the message. Otherwise undefined.
 *
 * @param body The JSON received by server on frame callback
 */
async function getFrameMessage(body, messageOptions) {
  // Validate the message
  const response = await neynarFrameFunctions.neynarFrameValidation(body?.trustedData?.messageBytes, messageOptions?.neynarApiKey || neynarFrameFunctions.NEYNAR_DEFAULT_API_KEY, messageOptions?.castReactionContext || true, messageOptions?.followContext || true);
  if (response?.valid) {
    return {
      isValid: true,
      message: response
    };
  } else {
    // Security best practice, don't return anything if we can't validate the frame.
    return {
      isValid: false,
      message: undefined
    };
  }
}
exports.getFrameMessage = getFrameMessage;
//# sourceMappingURL=getFrameMessage.js.map
